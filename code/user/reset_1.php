<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/hide.css">
    <link rel ="stylesheet" href="../css/reset.css">
</head>
<body class="bg-slate-600">
    <section class="reset">
        <form action="<?php echo htmlentities($_SERVER['PHP_SELF']);?>" method="post" autocomplete="off">
            <div class="mx-8 mt-8">
                <p class="text-2xl text-pink-600">An activation link will be send within 30 s to</p>
                <p class="text-2xl text-pink-600">your registerd email.</p> 
                <p class="text-2xl text-pink-600">To save changes visit your email.</p>
            </div>
            <div class="inline-grid lg:grid-cols-1 gap-4 p-8 mx-auto w-full">

                <div>
                    <label class="text-xl text-sky-500 block mb-1 font-large">User ID</label>
                    <input type="text" name="id"
                        class="bg-gray-800 bg-opacity-40 rounded border border-gray-700 focus:border-rose-600 focus:bg-gray-900 focus:ring-2 focus:ring-pink-600 text-base outline-none text-rose-100 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out w-full "
                        placeholder="Enter User ID *" required/>
                </div>

                <div>
                    <label class="text-xl text-sky-500 block mb-1 font-large">Email</label>
                    <input type="email" name="email"
                        class="bg-gray-800 bg-opacity-40 rounded border border-gray-700 focus:border-rose-600 focus:bg-gray-900 focus:ring-2 focus:ring-pink-600 text-base outline-none text-rose-100 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out w-full"
                        placeholder="Enter users's Email *" required/>
                </div>

                <div class="m-10">
                    <input type="submit" name="submit" value="SEND" 
                        class="flex text-white bg-purple-500 border-0 py-2 px-8 focus:outline-none hover:bg-purple-600 rounded text-lg cursor-pointer">
                </div>

            </div>
        </form>
        <!-- HL4    SVG      -->
        <div class = "fixed bottom-0 left-0 -z-10 opacity-60">
            <svg id="visual" viewBox="0 0 1920 1080" width="1920" height="1080" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><path d="M0 736L24.7 743.7C49.3 751.3 98.7 766.7 147.8 775.2C197 783.7 246 785.3 295.2 793.8C344.3 802.3 393.7 817.7 443 805.2C492.3 792.7 541.7 752.3 590.8 750.2C640 748 689 784 738.2 788.7C787.3 793.3 836.7 766.7 886 762C935.3 757.3 984.7 774.7 1034 775.8C1083.3 777 1132.7 762 1181.8 748.8C1231 735.7 1280 724.3 1329.2 728.5C1378.3 732.7 1427.7 752.3 1477 757.2C1526.3 762 1575.7 752 1624.8 755.3C1674 758.7 1723 775.3 1772.2 787.8C1821.3 800.3 1870.7 808.7 1895.3 812.8L1920 817L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00d8d6"></path><path d="M0 744L24.7 756C49.3 768 98.7 792 147.8 809.5C197 827 246 838 295.2 842.2C344.3 846.3 393.7 843.7 443 827.7C492.3 811.7 541.7 782.3 590.8 771.2C640 760 689 767 738.2 776.7C787.3 786.3 836.7 798.7 886 799C935.3 799.3 984.7 787.7 1034 780.2C1083.3 772.7 1132.7 769.3 1181.8 764C1231 758.7 1280 751.3 1329.2 750.3C1378.3 749.3 1427.7 754.7 1477 763.5C1526.3 772.3 1575.7 784.7 1624.8 791C1674 797.3 1723 797.7 1772.2 793.3C1821.3 789 1870.7 780 1895.3 775.5L1920 771L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00cfe0"></path><path d="M0 811L24.7 807.3C49.3 803.7 98.7 796.3 147.8 794.3C197 792.3 246 795.7 295.2 793.7C344.3 791.7 393.7 784.3 443 788C492.3 791.7 541.7 806.3 590.8 806.7C640 807 689 793 738.2 784.8C787.3 776.7 836.7 774.3 886 785.5C935.3 796.7 984.7 821.3 1034 834.8C1083.3 848.3 1132.7 850.7 1181.8 854.3C1231 858 1280 863 1329.2 862.2C1378.3 861.3 1427.7 854.7 1477 848.7C1526.3 842.7 1575.7 837.3 1624.8 836.8C1674 836.3 1723 840.7 1772.2 846.5C1821.3 852.3 1870.7 859.7 1895.3 863.3L1920 867L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00c4e8"></path><path d="M0 855L24.7 853C49.3 851 98.7 847 147.8 848C197 849 246 855 295.2 852.7C344.3 850.3 393.7 839.7 443 844.5C492.3 849.3 541.7 869.7 590.8 868.3C640 867 689 844 738.2 841.8C787.3 839.7 836.7 858.3 886 870C935.3 881.7 984.7 886.3 1034 887C1083.3 887.7 1132.7 884.3 1181.8 873.2C1231 862 1280 843 1329.2 837.8C1378.3 832.7 1427.7 841.3 1477 848.7C1526.3 856 1575.7 862 1624.8 866.7C1674 871.3 1723 874.7 1772.2 863.7C1821.3 852.7 1870.7 827.3 1895.3 814.7L1920 802L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00b9ee"></path><path d="M0 893L24.7 886.2C49.3 879.3 98.7 865.7 147.8 862.3C197 859 246 866 295.2 872.8C344.3 879.7 393.7 886.3 443 881C492.3 875.7 541.7 858.3 590.8 859.5C640 860.7 689 880.3 738.2 892.7C787.3 905 836.7 910 886 904C935.3 898 984.7 881 1034 874.8C1083.3 868.7 1132.7 873.3 1181.8 875.2C1231 877 1280 876 1329.2 879.8C1378.3 883.7 1427.7 892.3 1477 896.8C1526.3 901.3 1575.7 901.7 1624.8 897.5C1674 893.3 1723 884.7 1772.2 875.2C1821.3 865.7 1870.7 855.3 1895.3 850.2L1920 845L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00adf1"></path><path d="M0 911L24.7 915.2C49.3 919.3 98.7 927.7 147.8 931.2C197 934.7 246 933.3 295.2 930.7C344.3 928 393.7 924 443 916C492.3 908 541.7 896 590.8 888.7C640 881.3 689 878.7 738.2 887.2C787.3 895.7 836.7 915.3 886 919.7C935.3 924 984.7 913 1034 912.7C1083.3 912.3 1132.7 922.7 1181.8 921.2C1231 919.7 1280 906.3 1329.2 900.8C1378.3 895.3 1427.7 897.7 1477 901.2C1526.3 904.7 1575.7 909.3 1624.8 904.2C1674 899 1723 884 1772.2 880.2C1821.3 876.3 1870.7 883.7 1895.3 887.3L1920 891L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#00a0f0"></path><path d="M0 909L24.7 906.7C49.3 904.3 98.7 899.7 147.8 902.7C197 905.7 246 916.3 295.2 922.2C344.3 928 393.7 929 443 933.7C492.3 938.3 541.7 946.7 590.8 949C640 951.3 689 947.7 738.2 940.2C787.3 932.7 836.7 921.3 886 918.3C935.3 915.3 984.7 920.7 1034 924.2C1083.3 927.7 1132.7 929.3 1181.8 926.3C1231 923.3 1280 915.7 1329.2 908.2C1378.3 900.7 1427.7 893.3 1477 893.3C1526.3 893.3 1575.7 900.7 1624.8 911.3C1674 922 1723 936 1772.2 942.8C1821.3 949.7 1870.7 949.3 1895.3 949.2L1920 949L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#0092ec"></path><path d="M0 975L24.7 969.7C49.3 964.3 98.7 953.7 147.8 946C197 938.3 246 933.7 295.2 937.2C344.3 940.7 393.7 952.3 443 955.7C492.3 959 541.7 954 590.8 950.2C640 946.3 689 943.7 738.2 946.5C787.3 949.3 836.7 957.7 886 956.2C935.3 954.7 984.7 943.3 1034 945.3C1083.3 947.3 1132.7 962.7 1181.8 962.3C1231 962 1280 946 1329.2 946C1378.3 946 1427.7 962 1477 963C1526.3 964 1575.7 950 1624.8 941.2C1674 932.3 1723 928.7 1772.2 925.8C1821.3 923 1870.7 921 1895.3 920L1920 919L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#0083e8"></path><path d="M0 996L24.7 988.8C49.3 981.7 98.7 967.3 147.8 965.3C197 963.3 246 973.7 295.2 973.8C344.3 974 393.7 964 443 965.3C492.3 966.7 541.7 979.3 590.8 978.5C640 977.7 689 963.3 738.2 964.7C787.3 966 836.7 983 886 985.2C935.3 987.3 984.7 974.7 1034 966.7C1083.3 958.7 1132.7 955.3 1181.8 956.3C1231 957.3 1280 962.7 1329.2 968C1378.3 973.3 1427.7 978.7 1477 975.3C1526.3 972 1575.7 960 1624.8 953.3C1674 946.7 1723 945.3 1772.2 948.8C1821.3 952.3 1870.7 960.7 1895.3 964.8L1920 969L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#0074e2"></path><path d="M0 1004L24.7 1001.3C49.3 998.7 98.7 993.3 147.8 996.2C197 999 246 1010 295.2 1012.3C344.3 1014.7 393.7 1008.3 443 1001.2C492.3 994 541.7 986 590.8 986.8C640 987.7 689 997.3 738.2 999.7C787.3 1002 836.7 997 886 991.5C935.3 986 984.7 980 1034 980.8C1083.3 981.7 1132.7 989.3 1181.8 996.5C1231 1003.7 1280 1010.3 1329.2 1010.7C1378.3 1011 1427.7 1005 1477 1004.8C1526.3 1004.7 1575.7 1010.3 1624.8 1005.8C1674 1001.3 1723 986.7 1772.2 986C1821.3 985.3 1870.7 998.7 1895.3 1005.3L1920 1012L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#0164db"></path><path d="M0 1010L24.7 1009.3C49.3 1008.7 98.7 1007.3 147.8 1012.3C197 1017.3 246 1028.7 295.2 1029.2C344.3 1029.7 393.7 1019.3 443 1016.2C492.3 1013 541.7 1017 590.8 1020.5C640 1024 689 1027 738.2 1025.2C787.3 1023.3 836.7 1016.7 886 1014.2C935.3 1011.7 984.7 1013.3 1034 1015.8C1083.3 1018.3 1132.7 1021.7 1181.8 1024.3C1231 1027 1280 1029 1329.2 1030.2C1378.3 1031.3 1427.7 1031.7 1477 1031.5C1526.3 1031.3 1575.7 1030.7 1624.8 1030.8C1674 1031 1723 1032 1772.2 1030.3C1821.3 1028.7 1870.7 1024.3 1895.3 1022.2L1920 1020L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#2753d2"></path><path d="M0 1041L24.7 1043.5C49.3 1046 98.7 1051 147.8 1053.2C197 1055.3 246 1054.7 295.2 1050.8C344.3 1047 393.7 1040 443 1040.2C492.3 1040.3 541.7 1047.7 590.8 1048C640 1048.3 689 1041.7 738.2 1041.8C787.3 1042 836.7 1049 886 1048.7C935.3 1048.3 984.7 1040.7 1034 1040.7C1083.3 1040.7 1132.7 1048.3 1181.8 1051.8C1231 1055.3 1280 1054.7 1329.2 1054.2C1378.3 1053.7 1427.7 1053.3 1477 1053.3C1526.3 1053.3 1575.7 1053.7 1624.8 1051C1674 1048.3 1723 1042.7 1772.2 1038.7C1821.3 1034.7 1870.7 1032.3 1895.3 1031.2L1920 1030L1920 1081L1895.3 1081C1870.7 1081 1821.3 1081 1772.2 1081C1723 1081 1674 1081 1624.8 1081C1575.7 1081 1526.3 1081 1477 1081C1427.7 1081 1378.3 1081 1329.2 1081C1280 1081 1231 1081 1181.8 1081C1132.7 1081 1083.3 1081 1034 1081C984.7 1081 935.3 1081 886 1081C836.7 1081 787.3 1081 738.2 1081C689 1081 640 1081 590.8 1081C541.7 1081 492.3 1081 443 1081C393.7 1081 344.3 1081 295.2 1081C246 1081 197 1081 147.8 1081C98.7 1081 49.3 1081 24.7 1081L0 1081Z" fill="#3c40c6"></path></svg>
        </div>
    </section>
</body>
</html>


<!-- --------------------- -->
<!--------- php ------------->
<!-- --------------------- -->
            
<?php
    include "db_con.php";
    if(isset($_POST['submit']))
    {
        $id=mysqli_real_escape_string($connection,$_POST['id']);
        $email=mysqli_real_escape_string($connection,$_POST['email']);
        $selectquery="select * from user where user_ID='$id'";
        $query1=mysqli_query($connection,$selectquery);
        $id_count=mysqli_num_rows($query1);

        if($id_count)
        {
            $res=mysqli_fetch_assoc($query1);
            $dbemail=$res['email'];
            $token=$res['token'];
            $bits=bin2hex(random_bytes(10));
            if($dbemail==$email)
            {//valid
                $link="http://localhost/projects/on_going/code/user/reset_2.php?link=$token";
                $to_email = "$dbemail";
                $subject = "Reset Password.";
                $body = "Hello ".$res['post']." ".$res['name']." click this link to reset your password => ".$link;
                $headers = "From: userotp55@gmail.com";

                if (mail($to_email, $subject, $body, $headers)) 
                {
                    ?>
                        <script>
                            alert("Reset link has been send to your registered email address.");
                            location.replace("../index.php");
                        </script>
                    <?php
                }
                else 
                {
                    echo "Email sending failed...";
                }
            }
            else
            {//different email or id
               ?> 
                <script>
                    alert('Invalid email for user ID');
                </script>
               <?php 
            }
        }
        else
        {
            ?>
            <script>
                alert("Invalid User ID");
            </script>
            <?php
        }  
    }
?>
